{"version":3,"file":"gpxmap.js","sources":["../node_modules/pbf/index.js","../node_modules/point-geometry/index.js","../node_modules/vector-tile/lib/vectortilefeature.js","../node_modules/vector-tile/lib/vectortilelayer.js","../node_modules/vector-tile/lib/vectortile.js","../js/summary.js","../js/gpxmap.js","../js/flatMap.js","../Leaflet.VectorGrid/src/Leaflet.Renderer.SVG.Tile.js","../Leaflet.VectorGrid/src/Leaflet.VectorGrid.js","../node_modules/ieee754/index.js","../node_modules/vector-tile/index.js","../Leaflet.VectorGrid/src/Leaflet.VectorGrid.Protobuf.js","../Leaflet.VectorGrid/src/Leaflet.Renderer.Canvas.Tile.js"],"sourcesContent":["'use strict';\n\nmodule.exports = Pbf;\n\nvar ieee754 = require('ieee754');\n\nfunction Pbf(buf) {\n    this.buf = ArrayBuffer.isView && ArrayBuffer.isView(buf) ? buf : new Uint8Array(buf || 0);\n    this.pos = 0;\n    this.type = 0;\n    this.length = this.buf.length;\n}\n\nPbf.Varint  = 0; // varint: int32, int64, uint32, uint64, sint32, sint64, bool, enum\nPbf.Fixed64 = 1; // 64-bit: double, fixed64, sfixed64\nPbf.Bytes   = 2; // length-delimited: string, bytes, embedded messages, packed repeated fields\nPbf.Fixed32 = 5; // 32-bit: float, fixed32, sfixed32\n\nvar SHIFT_LEFT_32 = (1 << 16) * (1 << 16),\n    SHIFT_RIGHT_32 = 1 / SHIFT_LEFT_32;\n\nPbf.prototype = {\n\n    destroy: function() {\n        this.buf = null;\n    },\n\n    // === READING =================================================================\n\n    readFields: function(readField, result, end) {\n        end = end || this.length;\n\n        while (this.pos < end) {\n            var val = this.readVarint(),\n                tag = val >> 3,\n                startPos = this.pos;\n\n            this.type = val & 0x7;\n            readField(tag, result, this);\n\n            if (this.pos === startPos) this.skip(val);\n        }\n        return result;\n    },\n\n    readMessage: function(readField, result) {\n        return this.readFields(readField, result, this.readVarint() + this.pos);\n    },\n\n    readFixed32: function() {\n        var val = readUInt32(this.buf, this.pos);\n        this.pos += 4;\n        return val;\n    },\n\n    readSFixed32: function() {\n        var val = readInt32(this.buf, this.pos);\n        this.pos += 4;\n        return val;\n    },\n\n    // 64-bit int handling is based on github.com/dpw/node-buffer-more-ints (MIT-licensed)\n\n    readFixed64: function() {\n        var val = readUInt32(this.buf, this.pos) + readUInt32(this.buf, this.pos + 4) * SHIFT_LEFT_32;\n        this.pos += 8;\n        return val;\n    },\n\n    readSFixed64: function() {\n        var val = readUInt32(this.buf, this.pos) + readInt32(this.buf, this.pos + 4) * SHIFT_LEFT_32;\n        this.pos += 8;\n        return val;\n    },\n\n    readFloat: function() {\n        var val = ieee754.read(this.buf, this.pos, true, 23, 4);\n        this.pos += 4;\n        return val;\n    },\n\n    readDouble: function() {\n        var val = ieee754.read(this.buf, this.pos, true, 52, 8);\n        this.pos += 8;\n        return val;\n    },\n\n    readVarint: function(isSigned) {\n        var buf = this.buf,\n            val, b;\n\n        b = buf[this.pos++]; val  =  b & 0x7f;        if (b < 0x80) return val;\n        b = buf[this.pos++]; val |= (b & 0x7f) << 7;  if (b < 0x80) return val;\n        b = buf[this.pos++]; val |= (b & 0x7f) << 14; if (b < 0x80) return val;\n        b = buf[this.pos++]; val |= (b & 0x7f) << 21; if (b < 0x80) return val;\n        b = buf[this.pos];   val |= (b & 0x0f) << 28;\n\n        return readVarintRemainder(val, isSigned, this);\n    },\n\n    readVarint64: function() { // for compatibility with v2.0.1\n        return this.readVarint(true);\n    },\n\n    readSVarint: function() {\n        var num = this.readVarint();\n        return num % 2 === 1 ? (num + 1) / -2 : num / 2; // zigzag encoding\n    },\n\n    readBoolean: function() {\n        return Boolean(this.readVarint());\n    },\n\n    readString: function() {\n        var end = this.readVarint() + this.pos,\n            str = readUtf8(this.buf, this.pos, end);\n        this.pos = end;\n        return str;\n    },\n\n    readBytes: function() {\n        var end = this.readVarint() + this.pos,\n            buffer = this.buf.subarray(this.pos, end);\n        this.pos = end;\n        return buffer;\n    },\n\n    // verbose for performance reasons; doesn't affect gzipped size\n\n    readPackedVarint: function(arr, isSigned) {\n        var end = readPackedEnd(this);\n        arr = arr || [];\n        while (this.pos < end) arr.push(this.readVarint(isSigned));\n        return arr;\n    },\n    readPackedSVarint: function(arr) {\n        var end = readPackedEnd(this);\n        arr = arr || [];\n        while (this.pos < end) arr.push(this.readSVarint());\n        return arr;\n    },\n    readPackedBoolean: function(arr) {\n        var end = readPackedEnd(this);\n        arr = arr || [];\n        while (this.pos < end) arr.push(this.readBoolean());\n        return arr;\n    },\n    readPackedFloat: function(arr) {\n        var end = readPackedEnd(this);\n        arr = arr || [];\n        while (this.pos < end) arr.push(this.readFloat());\n        return arr;\n    },\n    readPackedDouble: function(arr) {\n        var end = readPackedEnd(this);\n        arr = arr || [];\n        while (this.pos < end) arr.push(this.readDouble());\n        return arr;\n    },\n    readPackedFixed32: function(arr) {\n        var end = readPackedEnd(this);\n        arr = arr || [];\n        while (this.pos < end) arr.push(this.readFixed32());\n        return arr;\n    },\n    readPackedSFixed32: function(arr) {\n        var end = readPackedEnd(this);\n        arr = arr || [];\n        while (this.pos < end) arr.push(this.readSFixed32());\n        return arr;\n    },\n    readPackedFixed64: function(arr) {\n        var end = readPackedEnd(this);\n        arr = arr || [];\n        while (this.pos < end) arr.push(this.readFixed64());\n        return arr;\n    },\n    readPackedSFixed64: function(arr) {\n        var end = readPackedEnd(this);\n        arr = arr || [];\n        while (this.pos < end) arr.push(this.readSFixed64());\n        return arr;\n    },\n\n    skip: function(val) {\n        var type = val & 0x7;\n        if (type === Pbf.Varint) while (this.buf[this.pos++] > 0x7f) {}\n        else if (type === Pbf.Bytes) this.pos = this.readVarint() + this.pos;\n        else if (type === Pbf.Fixed32) this.pos += 4;\n        else if (type === Pbf.Fixed64) this.pos += 8;\n        else throw new Error('Unimplemented type: ' + type);\n    },\n\n    // === WRITING =================================================================\n\n    writeTag: function(tag, type) {\n        this.writeVarint((tag << 3) | type);\n    },\n\n    realloc: function(min) {\n        var length = this.length || 16;\n\n        while (length < this.pos + min) length *= 2;\n\n        if (length !== this.length) {\n            var buf = new Uint8Array(length);\n            buf.set(this.buf);\n            this.buf = buf;\n            this.length = length;\n        }\n    },\n\n    finish: function() {\n        this.length = this.pos;\n        this.pos = 0;\n        return this.buf.subarray(0, this.length);\n    },\n\n    writeFixed32: function(val) {\n        this.realloc(4);\n        writeInt32(this.buf, val, this.pos);\n        this.pos += 4;\n    },\n\n    writeSFixed32: function(val) {\n        this.realloc(4);\n        writeInt32(this.buf, val, this.pos);\n        this.pos += 4;\n    },\n\n    writeFixed64: function(val) {\n        this.realloc(8);\n        writeInt32(this.buf, val & -1, this.pos);\n        writeInt32(this.buf, Math.floor(val * SHIFT_RIGHT_32), this.pos + 4);\n        this.pos += 8;\n    },\n\n    writeSFixed64: function(val) {\n        this.realloc(8);\n        writeInt32(this.buf, val & -1, this.pos);\n        writeInt32(this.buf, Math.floor(val * SHIFT_RIGHT_32), this.pos + 4);\n        this.pos += 8;\n    },\n\n    writeVarint: function(val) {\n        val = +val || 0;\n\n        if (val > 0xfffffff || val < 0) {\n            writeBigVarint(val, this);\n            return;\n        }\n\n        this.realloc(4);\n\n        this.buf[this.pos++] =           val & 0x7f  | (val > 0x7f ? 0x80 : 0); if (val <= 0x7f) return;\n        this.buf[this.pos++] = ((val >>>= 7) & 0x7f) | (val > 0x7f ? 0x80 : 0); if (val <= 0x7f) return;\n        this.buf[this.pos++] = ((val >>>= 7) & 0x7f) | (val > 0x7f ? 0x80 : 0); if (val <= 0x7f) return;\n        this.buf[this.pos++] =   (val >>> 7) & 0x7f;\n    },\n\n    writeSVarint: function(val) {\n        this.writeVarint(val < 0 ? -val * 2 - 1 : val * 2);\n    },\n\n    writeBoolean: function(val) {\n        this.writeVarint(Boolean(val));\n    },\n\n    writeString: function(str) {\n        str = String(str);\n        this.realloc(str.length * 4);\n\n        this.pos++; // reserve 1 byte for short string length\n\n        var startPos = this.pos;\n        // write the string directly to the buffer and see how much was written\n        this.pos = writeUtf8(this.buf, str, this.pos);\n        var len = this.pos - startPos;\n\n        if (len >= 0x80) makeRoomForExtraLength(startPos, len, this);\n\n        // finally, write the message length in the reserved place and restore the position\n        this.pos = startPos - 1;\n        this.writeVarint(len);\n        this.pos += len;\n    },\n\n    writeFloat: function(val) {\n        this.realloc(4);\n        ieee754.write(this.buf, val, this.pos, true, 23, 4);\n        this.pos += 4;\n    },\n\n    writeDouble: function(val) {\n        this.realloc(8);\n        ieee754.write(this.buf, val, this.pos, true, 52, 8);\n        this.pos += 8;\n    },\n\n    writeBytes: function(buffer) {\n        var len = buffer.length;\n        this.writeVarint(len);\n        this.realloc(len);\n        for (var i = 0; i < len; i++) this.buf[this.pos++] = buffer[i];\n    },\n\n    writeRawMessage: function(fn, obj) {\n        this.pos++; // reserve 1 byte for short message length\n\n        // write the message directly to the buffer and see how much was written\n        var startPos = this.pos;\n        fn(obj, this);\n        var len = this.pos - startPos;\n\n        if (len >= 0x80) makeRoomForExtraLength(startPos, len, this);\n\n        // finally, write the message length in the reserved place and restore the position\n        this.pos = startPos - 1;\n        this.writeVarint(len);\n        this.pos += len;\n    },\n\n    writeMessage: function(tag, fn, obj) {\n        this.writeTag(tag, Pbf.Bytes);\n        this.writeRawMessage(fn, obj);\n    },\n\n    writePackedVarint:   function(tag, arr) { this.writeMessage(tag, writePackedVarint, arr);   },\n    writePackedSVarint:  function(tag, arr) { this.writeMessage(tag, writePackedSVarint, arr);  },\n    writePackedBoolean:  function(tag, arr) { this.writeMessage(tag, writePackedBoolean, arr);  },\n    writePackedFloat:    function(tag, arr) { this.writeMessage(tag, writePackedFloat, arr);    },\n    writePackedDouble:   function(tag, arr) { this.writeMessage(tag, writePackedDouble, arr);   },\n    writePackedFixed32:  function(tag, arr) { this.writeMessage(tag, writePackedFixed32, arr);  },\n    writePackedSFixed32: function(tag, arr) { this.writeMessage(tag, writePackedSFixed32, arr); },\n    writePackedFixed64:  function(tag, arr) { this.writeMessage(tag, writePackedFixed64, arr);  },\n    writePackedSFixed64: function(tag, arr) { this.writeMessage(tag, writePackedSFixed64, arr); },\n\n    writeBytesField: function(tag, buffer) {\n        this.writeTag(tag, Pbf.Bytes);\n        this.writeBytes(buffer);\n    },\n    writeFixed32Field: function(tag, val) {\n        this.writeTag(tag, Pbf.Fixed32);\n        this.writeFixed32(val);\n    },\n    writeSFixed32Field: function(tag, val) {\n        this.writeTag(tag, Pbf.Fixed32);\n        this.writeSFixed32(val);\n    },\n    writeFixed64Field: function(tag, val) {\n        this.writeTag(tag, Pbf.Fixed64);\n        this.writeFixed64(val);\n    },\n    writeSFixed64Field: function(tag, val) {\n        this.writeTag(tag, Pbf.Fixed64);\n        this.writeSFixed64(val);\n    },\n    writeVarintField: function(tag, val) {\n        this.writeTag(tag, Pbf.Varint);\n        this.writeVarint(val);\n    },\n    writeSVarintField: function(tag, val) {\n        this.writeTag(tag, Pbf.Varint);\n        this.writeSVarint(val);\n    },\n    writeStringField: function(tag, str) {\n        this.writeTag(tag, Pbf.Bytes);\n        this.writeString(str);\n    },\n    writeFloatField: function(tag, val) {\n        this.writeTag(tag, Pbf.Fixed32);\n        this.writeFloat(val);\n    },\n    writeDoubleField: function(tag, val) {\n        this.writeTag(tag, Pbf.Fixed64);\n        this.writeDouble(val);\n    },\n    writeBooleanField: function(tag, val) {\n        this.writeVarintField(tag, Boolean(val));\n    }\n};\n\nfunction readVarintRemainder(l, s, p) {\n    var buf = p.buf,\n        h, b;\n\n    b = buf[p.pos++]; h  = (b & 0x70) >> 4;  if (b < 0x80) return toNum(l, h, s);\n    b = buf[p.pos++]; h |= (b & 0x7f) << 3;  if (b < 0x80) return toNum(l, h, s);\n    b = buf[p.pos++]; h |= (b & 0x7f) << 10; if (b < 0x80) return toNum(l, h, s);\n    b = buf[p.pos++]; h |= (b & 0x7f) << 17; if (b < 0x80) return toNum(l, h, s);\n    b = buf[p.pos++]; h |= (b & 0x7f) << 24; if (b < 0x80) return toNum(l, h, s);\n    b = buf[p.pos++]; h |= (b & 0x01) << 31; if (b < 0x80) return toNum(l, h, s);\n\n    throw new Error('Expected varint not more than 10 bytes');\n}\n\nfunction readPackedEnd(pbf) {\n    return pbf.type === Pbf.Bytes ?\n        pbf.readVarint() + pbf.pos : pbf.pos + 1;\n}\n\nfunction toNum(low, high, isSigned) {\n    if (isSigned) {\n        return high * 0x100000000 + (low >>> 0);\n    }\n\n    return ((high >>> 0) * 0x100000000) + (low >>> 0);\n}\n\nfunction writeBigVarint(val, pbf) {\n    var low, high;\n\n    if (val >= 0) {\n        low  = (val % 0x100000000) | 0;\n        high = (val / 0x100000000) | 0;\n    } else {\n        low  = ~(-val % 0x100000000);\n        high = ~(-val / 0x100000000);\n\n        if (low ^ 0xffffffff) {\n            low = (low + 1) | 0;\n        } else {\n            low = 0;\n            high = (high + 1) | 0;\n        }\n    }\n\n    if (val >= 0x10000000000000000 || val < -0x10000000000000000) {\n        throw new Error('Given varint doesn\\'t fit into 10 bytes');\n    }\n\n    pbf.realloc(10);\n\n    writeBigVarintLow(low, high, pbf);\n    writeBigVarintHigh(high, pbf);\n}\n\nfunction writeBigVarintLow(low, high, pbf) {\n    pbf.buf[pbf.pos++] = low & 0x7f | 0x80; low >>>= 7;\n    pbf.buf[pbf.pos++] = low & 0x7f | 0x80; low >>>= 7;\n    pbf.buf[pbf.pos++] = low & 0x7f | 0x80; low >>>= 7;\n    pbf.buf[pbf.pos++] = low & 0x7f | 0x80; low >>>= 7;\n    pbf.buf[pbf.pos]   = low & 0x7f;\n}\n\nfunction writeBigVarintHigh(high, pbf) {\n    var lsb = (high & 0x07) << 4;\n\n    pbf.buf[pbf.pos++] |= lsb         | ((high >>>= 3) ? 0x80 : 0); if (!high) return;\n    pbf.buf[pbf.pos++]  = high & 0x7f | ((high >>>= 7) ? 0x80 : 0); if (!high) return;\n    pbf.buf[pbf.pos++]  = high & 0x7f | ((high >>>= 7) ? 0x80 : 0); if (!high) return;\n    pbf.buf[pbf.pos++]  = high & 0x7f | ((high >>>= 7) ? 0x80 : 0); if (!high) return;\n    pbf.buf[pbf.pos++]  = high & 0x7f | ((high >>>= 7) ? 0x80 : 0); if (!high) return;\n    pbf.buf[pbf.pos++]  = high & 0x7f;\n}\n\nfunction makeRoomForExtraLength(startPos, len, pbf) {\n    var extraLen =\n        len <= 0x3fff ? 1 :\n        len <= 0x1fffff ? 2 :\n        len <= 0xfffffff ? 3 : Math.ceil(Math.log(len) / (Math.LN2 * 7));\n\n    // if 1 byte isn't enough for encoding message length, shift the data to the right\n    pbf.realloc(extraLen);\n    for (var i = pbf.pos - 1; i >= startPos; i--) pbf.buf[i + extraLen] = pbf.buf[i];\n}\n\nfunction writePackedVarint(arr, pbf)   { for (var i = 0; i < arr.length; i++) pbf.writeVarint(arr[i]);   }\nfunction writePackedSVarint(arr, pbf)  { for (var i = 0; i < arr.length; i++) pbf.writeSVarint(arr[i]);  }\nfunction writePackedFloat(arr, pbf)    { for (var i = 0; i < arr.length; i++) pbf.writeFloat(arr[i]);    }\nfunction writePackedDouble(arr, pbf)   { for (var i = 0; i < arr.length; i++) pbf.writeDouble(arr[i]);   }\nfunction writePackedBoolean(arr, pbf)  { for (var i = 0; i < arr.length; i++) pbf.writeBoolean(arr[i]);  }\nfunction writePackedFixed32(arr, pbf)  { for (var i = 0; i < arr.length; i++) pbf.writeFixed32(arr[i]);  }\nfunction writePackedSFixed32(arr, pbf) { for (var i = 0; i < arr.length; i++) pbf.writeSFixed32(arr[i]); }\nfunction writePackedFixed64(arr, pbf)  { for (var i = 0; i < arr.length; i++) pbf.writeFixed64(arr[i]);  }\nfunction writePackedSFixed64(arr, pbf) { for (var i = 0; i < arr.length; i++) pbf.writeSFixed64(arr[i]); }\n\n// Buffer code below from https://github.com/feross/buffer, MIT-licensed\n\nfunction readUInt32(buf, pos) {\n    return ((buf[pos]) |\n        (buf[pos + 1] << 8) |\n        (buf[pos + 2] << 16)) +\n        (buf[pos + 3] * 0x1000000);\n}\n\nfunction writeInt32(buf, val, pos) {\n    buf[pos] = val;\n    buf[pos + 1] = (val >>> 8);\n    buf[pos + 2] = (val >>> 16);\n    buf[pos + 3] = (val >>> 24);\n}\n\nfunction readInt32(buf, pos) {\n    return ((buf[pos]) |\n        (buf[pos + 1] << 8) |\n        (buf[pos + 2] << 16)) +\n        (buf[pos + 3] << 24);\n}\n\nfunction readUtf8(buf, pos, end) {\n    var str = '';\n    var i = pos;\n\n    while (i < end) {\n        var b0 = buf[i];\n        var c = null; // codepoint\n        var bytesPerSequence =\n            b0 > 0xEF ? 4 :\n            b0 > 0xDF ? 3 :\n            b0 > 0xBF ? 2 : 1;\n\n        if (i + bytesPerSequence > end) break;\n\n        var b1, b2, b3;\n\n        if (bytesPerSequence === 1) {\n            if (b0 < 0x80) {\n                c = b0;\n            }\n        } else if (bytesPerSequence === 2) {\n            b1 = buf[i + 1];\n            if ((b1 & 0xC0) === 0x80) {\n                c = (b0 & 0x1F) << 0x6 | (b1 & 0x3F);\n                if (c <= 0x7F) {\n                    c = null;\n                }\n            }\n        } else if (bytesPerSequence === 3) {\n            b1 = buf[i + 1];\n            b2 = buf[i + 2];\n            if ((b1 & 0xC0) === 0x80 && (b2 & 0xC0) === 0x80) {\n                c = (b0 & 0xF) << 0xC | (b1 & 0x3F) << 0x6 | (b2 & 0x3F);\n                if (c <= 0x7FF || (c >= 0xD800 && c <= 0xDFFF)) {\n                    c = null;\n                }\n            }\n        } else if (bytesPerSequence === 4) {\n            b1 = buf[i + 1];\n            b2 = buf[i + 2];\n            b3 = buf[i + 3];\n            if ((b1 & 0xC0) === 0x80 && (b2 & 0xC0) === 0x80 && (b3 & 0xC0) === 0x80) {\n                c = (b0 & 0xF) << 0x12 | (b1 & 0x3F) << 0xC | (b2 & 0x3F) << 0x6 | (b3 & 0x3F);\n                if (c <= 0xFFFF || c >= 0x110000) {\n                    c = null;\n                }\n            }\n        }\n\n        if (c === null) {\n            c = 0xFFFD;\n            bytesPerSequence = 1;\n\n        } else if (c > 0xFFFF) {\n            c -= 0x10000;\n            str += String.fromCharCode(c >>> 10 & 0x3FF | 0xD800);\n            c = 0xDC00 | c & 0x3FF;\n        }\n\n        str += String.fromCharCode(c);\n        i += bytesPerSequence;\n    }\n\n    return str;\n}\n\nfunction writeUtf8(buf, str, pos) {\n    for (var i = 0, c, lead; i < str.length; i++) {\n        c = str.charCodeAt(i); // code point\n\n        if (c > 0xD7FF && c < 0xE000) {\n            if (lead) {\n                if (c < 0xDC00) {\n                    buf[pos++] = 0xEF;\n                    buf[pos++] = 0xBF;\n                    buf[pos++] = 0xBD;\n                    lead = c;\n                    continue;\n                } else {\n                    c = lead - 0xD800 << 10 | c - 0xDC00 | 0x10000;\n                    lead = null;\n                }\n            } else {\n                if (c > 0xDBFF || (i + 1 === str.length)) {\n                    buf[pos++] = 0xEF;\n                    buf[pos++] = 0xBF;\n                    buf[pos++] = 0xBD;\n                } else {\n                    lead = c;\n                }\n                continue;\n            }\n        } else if (lead) {\n            buf[pos++] = 0xEF;\n            buf[pos++] = 0xBF;\n            buf[pos++] = 0xBD;\n            lead = null;\n        }\n\n        if (c < 0x80) {\n            buf[pos++] = c;\n        } else {\n            if (c < 0x800) {\n                buf[pos++] = c >> 0x6 | 0xC0;\n            } else {\n                if (c < 0x10000) {\n                    buf[pos++] = c >> 0xC | 0xE0;\n                } else {\n                    buf[pos++] = c >> 0x12 | 0xF0;\n                    buf[pos++] = c >> 0xC & 0x3F | 0x80;\n                }\n                buf[pos++] = c >> 0x6 & 0x3F | 0x80;\n            }\n            buf[pos++] = c & 0x3F | 0x80;\n        }\n    }\n    return pos;\n}\n","'use strict';\n\nmodule.exports = Point;\n\nfunction Point(x, y) {\n    this.x = x;\n    this.y = y;\n}\n\nPoint.prototype = {\n    clone: function() { return new Point(this.x, this.y); },\n\n    add:     function(p) { return this.clone()._add(p);     },\n    sub:     function(p) { return this.clone()._sub(p);     },\n    mult:    function(k) { return this.clone()._mult(k);    },\n    div:     function(k) { return this.clone()._div(k);     },\n    rotate:  function(a) { return this.clone()._rotate(a);  },\n    matMult: function(m) { return this.clone()._matMult(m); },\n    unit:    function() { return this.clone()._unit(); },\n    perp:    function() { return this.clone()._perp(); },\n    round:   function() { return this.clone()._round(); },\n\n    mag: function() {\n        return Math.sqrt(this.x * this.x + this.y * this.y);\n    },\n\n    equals: function(p) {\n        return this.x === p.x &&\n               this.y === p.y;\n    },\n\n    dist: function(p) {\n        return Math.sqrt(this.distSqr(p));\n    },\n\n    distSqr: function(p) {\n        var dx = p.x - this.x,\n            dy = p.y - this.y;\n        return dx * dx + dy * dy;\n    },\n\n    angle: function() {\n        return Math.atan2(this.y, this.x);\n    },\n\n    angleTo: function(b) {\n        return Math.atan2(this.y - b.y, this.x - b.x);\n    },\n\n    angleWith: function(b) {\n        return this.angleWithSep(b.x, b.y);\n    },\n\n    // Find the angle of the two vectors, solving the formula for the cross product a x b = |a||b|sin(θ) for θ.\n    angleWithSep: function(x, y) {\n        return Math.atan2(\n            this.x * y - this.y * x,\n            this.x * x + this.y * y);\n    },\n\n    _matMult: function(m) {\n        var x = m[0] * this.x + m[1] * this.y,\n            y = m[2] * this.x + m[3] * this.y;\n        this.x = x;\n        this.y = y;\n        return this;\n    },\n\n    _add: function(p) {\n        this.x += p.x;\n        this.y += p.y;\n        return this;\n    },\n\n    _sub: function(p) {\n        this.x -= p.x;\n        this.y -= p.y;\n        return this;\n    },\n\n    _mult: function(k) {\n        this.x *= k;\n        this.y *= k;\n        return this;\n    },\n\n    _div: function(k) {\n        this.x /= k;\n        this.y /= k;\n        return this;\n    },\n\n    _unit: function() {\n        this._div(this.mag());\n        return this;\n    },\n\n    _perp: function() {\n        var y = this.y;\n        this.y = this.x;\n        this.x = -y;\n        return this;\n    },\n\n    _rotate: function(angle) {\n        var cos = Math.cos(angle),\n            sin = Math.sin(angle),\n            x = cos * this.x - sin * this.y,\n            y = sin * this.x + cos * this.y;\n        this.x = x;\n        this.y = y;\n        return this;\n    },\n\n    _round: function() {\n        this.x = Math.round(this.x);\n        this.y = Math.round(this.y);\n        return this;\n    }\n};\n\n// constructs Point from an array if necessary\nPoint.convert = function (a) {\n    if (a instanceof Point) {\n        return a;\n    }\n    if (Array.isArray(a)) {\n        return new Point(a[0], a[1]);\n    }\n    return a;\n};\n","'use strict';\n\nvar Point = require('point-geometry');\n\nmodule.exports = VectorTileFeature;\n\nfunction VectorTileFeature(pbf, end, extent, keys, values) {\n    // Public\n    this.properties = {};\n    this.extent = extent;\n    this.type = 0;\n\n    // Private\n    this._pbf = pbf;\n    this._geometry = -1;\n    this._keys = keys;\n    this._values = values;\n\n    pbf.readFields(readFeature, this, end);\n}\n\nfunction readFeature(tag, feature, pbf) {\n    if (tag == 1) feature.id = pbf.readVarint();\n    else if (tag == 2) readTag(pbf, feature);\n    else if (tag == 3) feature.type = pbf.readVarint();\n    else if (tag == 4) feature._geometry = pbf.pos;\n}\n\nfunction readTag(pbf, feature) {\n    var end = pbf.readVarint() + pbf.pos;\n\n    while (pbf.pos < end) {\n        var key = feature._keys[pbf.readVarint()],\n            value = feature._values[pbf.readVarint()];\n        feature.properties[key] = value;\n    }\n}\n\nVectorTileFeature.types = ['Unknown', 'Point', 'LineString', 'Polygon'];\n\nVectorTileFeature.prototype.loadGeometry = function() {\n    var pbf = this._pbf;\n    pbf.pos = this._geometry;\n\n    var end = pbf.readVarint() + pbf.pos,\n        cmd = 1,\n        length = 0,\n        x = 0,\n        y = 0,\n        lines = [],\n        line;\n\n    while (pbf.pos < end) {\n        if (!length) {\n            var cmdLen = pbf.readVarint();\n            cmd = cmdLen & 0x7;\n            length = cmdLen >> 3;\n        }\n\n        length--;\n\n        if (cmd === 1 || cmd === 2) {\n            x += pbf.readSVarint();\n            y += pbf.readSVarint();\n\n            if (cmd === 1) { // moveTo\n                if (line) lines.push(line);\n                line = [];\n            }\n\n            line.push(new Point(x, y));\n\n        } else if (cmd === 7) {\n\n            // Workaround for https://github.com/mapbox/mapnik-vector-tile/issues/90\n            if (line) {\n                line.push(line[0].clone()); // closePolygon\n            }\n\n        } else {\n            throw new Error('unknown command ' + cmd);\n        }\n    }\n\n    if (line) lines.push(line);\n\n    return lines;\n};\n\nVectorTileFeature.prototype.bbox = function() {\n    var pbf = this._pbf;\n    pbf.pos = this._geometry;\n\n    var end = pbf.readVarint() + pbf.pos,\n        cmd = 1,\n        length = 0,\n        x = 0,\n        y = 0,\n        x1 = Infinity,\n        x2 = -Infinity,\n        y1 = Infinity,\n        y2 = -Infinity;\n\n    while (pbf.pos < end) {\n        if (!length) {\n            var cmdLen = pbf.readVarint();\n            cmd = cmdLen & 0x7;\n            length = cmdLen >> 3;\n        }\n\n        length--;\n\n        if (cmd === 1 || cmd === 2) {\n            x += pbf.readSVarint();\n            y += pbf.readSVarint();\n            if (x < x1) x1 = x;\n            if (x > x2) x2 = x;\n            if (y < y1) y1 = y;\n            if (y > y2) y2 = y;\n\n        } else if (cmd !== 7) {\n            throw new Error('unknown command ' + cmd);\n        }\n    }\n\n    return [x1, y1, x2, y2];\n};\n\nVectorTileFeature.prototype.toGeoJSON = function(x, y, z) {\n    var size = this.extent * Math.pow(2, z),\n        x0 = this.extent * x,\n        y0 = this.extent * y,\n        coords = this.loadGeometry(),\n        type = VectorTileFeature.types[this.type],\n        i, j;\n\n    function project(line) {\n        for (var j = 0; j < line.length; j++) {\n            var p = line[j], y2 = 180 - (p.y + y0) * 360 / size;\n            line[j] = [\n                (p.x + x0) * 360 / size - 180,\n                360 / Math.PI * Math.atan(Math.exp(y2 * Math.PI / 180)) - 90\n            ];\n        }\n    }\n\n    switch (this.type) {\n    case 1:\n        var points = [];\n        for (i = 0; i < coords.length; i++) {\n            points[i] = coords[i][0];\n        }\n        coords = points;\n        project(coords);\n        break;\n\n    case 2:\n        for (i = 0; i < coords.length; i++) {\n            project(coords[i]);\n        }\n        break;\n\n    case 3:\n        coords = classifyRings(coords);\n        for (i = 0; i < coords.length; i++) {\n            for (j = 0; j < coords[i].length; j++) {\n                project(coords[i][j]);\n            }\n        }\n        break;\n    }\n\n    if (coords.length === 1) {\n        coords = coords[0];\n    } else {\n        type = 'Multi' + type;\n    }\n\n    var result = {\n        type: \"Feature\",\n        geometry: {\n            type: type,\n            coordinates: coords\n        },\n        properties: this.properties\n    };\n\n    if ('id' in this) {\n        result.id = this.id;\n    }\n\n    return result;\n};\n\n// classifies an array of rings into polygons with outer rings and holes\n\nfunction classifyRings(rings) {\n    var len = rings.length;\n\n    if (len <= 1) return [rings];\n\n    var polygons = [],\n        polygon,\n        ccw;\n\n    for (var i = 0; i < len; i++) {\n        var area = signedArea(rings[i]);\n        if (area === 0) continue;\n\n        if (ccw === undefined) ccw = area < 0;\n\n        if (ccw === area < 0) {\n            if (polygon) polygons.push(polygon);\n            polygon = [rings[i]];\n\n        } else {\n            polygon.push(rings[i]);\n        }\n    }\n    if (polygon) polygons.push(polygon);\n\n    return polygons;\n}\n\nfunction signedArea(ring) {\n    var sum = 0;\n    for (var i = 0, len = ring.length, j = len - 1, p1, p2; i < len; j = i++) {\n        p1 = ring[i];\n        p2 = ring[j];\n        sum += (p2.x - p1.x) * (p1.y + p2.y);\n    }\n    return sum;\n}\n","'use strict';\n\nvar VectorTileFeature = require('./vectortilefeature.js');\n\nmodule.exports = VectorTileLayer;\n\nfunction VectorTileLayer(pbf, end) {\n    // Public\n    this.version = 1;\n    this.name = null;\n    this.extent = 4096;\n    this.length = 0;\n\n    // Private\n    this._pbf = pbf;\n    this._keys = [];\n    this._values = [];\n    this._features = [];\n\n    pbf.readFields(readLayer, this, end);\n\n    this.length = this._features.length;\n}\n\nfunction readLayer(tag, layer, pbf) {\n    if (tag === 15) layer.version = pbf.readVarint();\n    else if (tag === 1) layer.name = pbf.readString();\n    else if (tag === 5) layer.extent = pbf.readVarint();\n    else if (tag === 2) layer._features.push(pbf.pos);\n    else if (tag === 3) layer._keys.push(pbf.readString());\n    else if (tag === 4) layer._values.push(readValueMessage(pbf));\n}\n\nfunction readValueMessage(pbf) {\n    var value = null,\n        end = pbf.readVarint() + pbf.pos;\n\n    while (pbf.pos < end) {\n        var tag = pbf.readVarint() >> 3;\n\n        value = tag === 1 ? pbf.readString() :\n            tag === 2 ? pbf.readFloat() :\n            tag === 3 ? pbf.readDouble() :\n            tag === 4 ? pbf.readVarint64() :\n            tag === 5 ? pbf.readVarint() :\n            tag === 6 ? pbf.readSVarint() :\n            tag === 7 ? pbf.readBoolean() : null;\n    }\n\n    return value;\n}\n\n// return feature `i` from this layer as a `VectorTileFeature`\nVectorTileLayer.prototype.feature = function(i) {\n    if (i < 0 || i >= this._features.length) throw new Error('feature index out of bounds');\n\n    this._pbf.pos = this._features[i];\n\n    var end = this._pbf.readVarint() + this._pbf.pos;\n    return new VectorTileFeature(this._pbf, end, this.extent, this._keys, this._values);\n};\n","'use strict';\n\nvar VectorTileLayer = require('./vectortilelayer');\n\nmodule.exports = VectorTile;\n\nfunction VectorTile(pbf, end) {\n    this.layers = pbf.readFields(readTile, {}, end);\n}\n\nfunction readTile(tag, layers, pbf) {\n    if (tag === 3) {\n        var layer = new VectorTileLayer(pbf, pbf.readVarint() + pbf.pos);\n        if (layer.length) layers[layer.name] = layer;\n    }\n}\n\n","/*\n * Copyright 2017, Joachim Kuebart <joachim.kuebart@gmail.com>\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *\n *   1. Redistributions of source code must retain the above copyright\n *\tnotice, this list of conditions and the following disclaimer.\n *\n *   2. Redistributions in binary form must reproduce the above copyright\n *\tnotice, this list of conditions and the following disclaimer in the\n *\tdocumentation and/or other materials provided with the\n *\tdistribution.\n *\n *   3. Neither the name of the copyright holder nor the names of its\n *\tcontributors may be used to endorse or promote products derived\n *\tfrom this software without specific prior written permission.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\"\n * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE\n * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE\n * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF\n * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS\n * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN\n * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n * POSSIBILITY OF SUCH DAMAGE.\n */\n\nimport './flatMap.js';\n\n    function zip() {\n\tconst args = Array.prototype.slice.call(arguments);\n\treturn Object.keys(args[0]).map(i => args.map(a => a[i]));\n    }\n\n    /**\n     * An immutable value type for summaries.\n     */\n    function summary() {\n\treturn summaryImp(0, 0);\n\n\t// Private implementation\n\tfunction summaryImp(m_walks, m_distance) {\n\t    const self = {};\n\n\t    self.walks = () => m_walks;\n\t    self.distance = () => m_distance;\n\n\t    self.toString = function () {\n\t\treturn [\n\t\t    `${m_walks} walks`, +(m_distance / 1000).toFixed(1) +'km',\n\t\t].join(' — ');\n\t    };\n\n\t    self.accumulate = function (dist) {\n\t\treturn summaryImp(1 + m_walks, dist + m_distance);\n\t    };\n\n\t    return self;\n\t}\n    }\n\n    /**\n     * The summary pane reacts to changes in the visible year layers.\n     */\n    export function summaryPane(walks, onChange) {\n\tconst self = {};\n\tconst m_visibleYears = {};\n\tlet m_summary = summary();\n\n\tfunction handleVisible(year, visible) {\n\t    if (visible != m_visibleYears[year]) {\n\t\tm_visibleYears[year] = visible;\n\t\tm_summary = walks.flatMap(\n\t\t\twalk => zip(walk.dates, walk.distances)\n\t\t    ).reduce(function (sum, dateDistance) {\n\t\t\tif (m_visibleYears[dateDistance[0].substr(0, 4)]) {\n\t\t\t    return sum.accumulate(dateDistance[1]);\n\t\t\t} else {\n\t\t\t    return sum;\n\t\t\t}\n\t\t    }, summary());\n\t\tif (onChange) {\n\t\t    onChange.call(self);\n\t\t}\n\t    }\n\t}\n\n\tself.addLayer = function (layer, year) {\n\t    layer.on('add', handleVisible.bind(null, year, true)).\n\t\ton('remove', handleVisible.bind(null, year, false));\n\t    return self;\n\t};\n\n\tself.removeLayer = function (layer) {\n\t    layer.off('add').off('remove');\n\t    return self;\n\t};\n\n\tself.render = function () {\n\t    const frag = document.createDocumentFragment();\n\t    if (m_summary.walks()) {\n\t\tconst div = document.createElement('div');\n\t\tdiv.textContent = ''+ m_summary;\n\t\tfrag.appendChild(div);\n\t    }\n\t    return frag;\n\t};\n\n\treturn self;\n    }\n","/*\n * Copyright 2017, Joachim Kuebart <joachim.kuebart@gmail.com>\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *\n *   1. Redistributions of source code must retain the above copyright\n *\tnotice, this list of conditions and the following disclaimer.\n *\n *   2. Redistributions in binary form must reproduce the above copyright\n *\tnotice, this list of conditions and the following disclaimer in the\n *\tdocumentation and/or other materials provided with the\n *\tdistribution.\n *\n *   3. Neither the name of the copyright holder nor the names of its\n *\tcontributors may be used to endorse or promote products derived\n *\tfrom this software without specific prior written permission.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\"\n * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE\n * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE\n * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF\n * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS\n * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN\n * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n * POSSIBILITY OF SUCH DAMAGE.\n */\n\nimport './flatMap.js';\nimport L from 'leaflet';\nimport {} from './VectorGrid';\nimport require from 'require';\nimport { summaryPane } from './summary.js';\n\nexport const CSS = {\n    'DETAILS': 'gpxmap-details',\n    'HBOX': 'gpxmap-hbox',\n    'SELECT': 'gpxmap-select',\n    'TRACK': 'gpxmap-track',\n    'VBOX': 'gpxmap-vbox',\n    'VIEW': 'gpxmap-view',\n};\n\n/**\n * If this looks familiar that's because it's binary search. We find\n * 0 <= i <= array.length such that !pred(i - 1) && pred(i) under the\n * assumption !pred(-1) && pred(length).\n */\nfunction search(array, pred) {\n    let le = -1, ri = array.length;\n    while (1 + le !== ri) {\n\tconst mi = le + ((ri - le) >> 1);\n\tif (pred(array[mi])) {\n\t    ri = mi;\n\t} else {\n\t    le = mi;\n\t}\n    }\n    return ri;\n}\n\nfunction yearColour(idx) {\n    return ['hsl(',\n\t170 + 45 * (idx >> 1), ',',\n\t100, '%,',\n\t27 * (1 + idx % 2), '%)'\n    ].join('');\n}\n\nfunction walkPopup(date, walk) {\n    const idx = search(walk.dates, d => date <= d);\n\n    if (walk.dates[idx] !== date) {\n\tconsole.log('walkPopup', date, walk);\n\treturn;\n    }\n\n    const popup = document.createDocumentFragment();\n    let elem0 = document.createElement('div');\n    elem0.textContent = [\n\t    [ +date.substr(8, 2)\n\t    , +date.substr(5, 2)\n\t    , +date.substr(0, 4)\n\t    ].join('/'),\n\t    +(walk.distances[idx] / 1000).toFixed(1) +'km',\n\t    `${walk.walkers} walkers`,\n\t    walk.categories.join(' — '),\n\t    '',\n\t].join(' — ');\n\n    const anchor = document.createElement('a');\n    anchor.setAttribute('href', walk.link);\n    anchor.textContent = 'blog';\n    elem0.appendChild(anchor);\n    popup.appendChild(elem0);\n\n    elem0 = document.createElement('p');\n    elem0.textContent = walk.people.sort().join(' • ');\n    popup.appendChild(elem0);\n\n    return { 'title': walk.title, 'content': popup };\n}\n\nfunction getFeatureId(walk) {\n    return walk.properties.date;\n}\n\nfunction locationState(obj) {\n    const state = window.history.state || {};\n\n    if (obj) {\n\tObject.keys(obj).forEach(k => state[k] = obj[k]);\n\twindow.history.replaceState(state, window.document.title);\n    }\n\n    return state;\n}\n\nfunction locationItem(key) {\n    return function(value) {\n\tif (!arguments.length) {\n\t    return locationState()[key];\n\t}\n\n\tlocationState({ [key]: value });\n\treturn value;\n    }\n}\n\nfunction savedLocation(l) {\n    if (!arguments.length) {\n\treturn locationState()['@'];\n    }\n\n    const { lat, lng } = L.latLng(l);\n    locationState({ '@': [ lat, lng ].map(f => +f.toFixed(6)) });\n    return l;\n}\n\nconst savedZoom = locationItem('z');\nconst selected = locationItem('s');\n\nfunction hiddenYear(year, hidden) {\n    const state = [].concat(locationState()['y'] || []);\n    if (arguments.length < 2) {\n\treturn 0 <= state.indexOf(`${year}`);\n    }\n\n    const years = state.reduce((h, k) => (h[k] = true, h), {});\n    years[year] = hidden;\n    const newState = Object.keys(years).filter(k => years[k]).sort();\n    locationState({ 'y': newState.length ? newState : void 0 });\n    return hidden;\n}\n\nexport function gpxmap(id, options) {\n    // Create all configured tile layers.\n    const tileLayers = options.tileLayers.map(function (layer) {\n\treturn {\n\t    'name': layer.name,\n\t    'tileLayer': L.tileLayer(layer.url, layer.options),\n\t};\n    });\n\n    // Create layers control.\n    const layersControl = L.control.layers(null, null, { 'hideSingleBase':true });\n    tileLayers.forEach(function (layer) {\n\tlayersControl.addBaseLayer(layer.tileLayer, layer.name);\n    });\n\n    // Create the DOM structure for our map.\n    const domContainer = L.DomUtil.get(id);\n    L.DomUtil.addClass(domContainer, CSS.VBOX);\n\n    // Create map with an initial tile layer and layers control.\n    const gpxmap = L.map(L.DomUtil.create('div', CSS.VIEW, domContainer)).\n\taddControl(L.control.scale()).\n\taddControl(layersControl).\n\taddLayer(tileLayers[0].tileLayer);\n\n    const domDetails = L.DomUtil.create('div', CSS.DETAILS, domContainer);\n    function renderDetails({ title, content }) {\n\tconst h3 = L.DomUtil.create('h3');\n\n\th3.textContent = title;\n\tL.DomUtil.empty(domDetails);\n\tdomDetails.appendChild(h3);\n\tdomDetails.appendChild(content);\n    }\n\n    function trackStyle(hover) {\n\treturn function (props) {\n\t    const date = props.date;\n\t    const year = date.substr(0, 4);\n\t    return hiddenYear(year) ? [] : {\n\t\t'className': CSS.TRACK,\n\t\t'color': yearColour(year - 2011),\n\t\t'opacity': hover ? 1 : .8,\n\t\t'weight': hover ? 4 : date === selected() ? 3.5 : 2,\n\t\t'interactive': false,\n\t    };\n\t};\n    }\n\n    // This layer shows walking tracks.\n    const walkLayer = L.vectorGrid.protobuf(\n\toptions.url, {\n\t    'pane': 'overlayPane',\n\t    'maxNativeZoom': 13,\n\t    getFeatureId,\n\t    'vectorTileLayerStyles': { '': trackStyle() },\n\t}\n    ).addTo(gpxmap);\n\n    // This layer has invisible mouse-responsive tracks.\n    const mouseLayer = L.vectorGrid.protobuf(\n\toptions.url, {\n\t    'pane': 'overlayPane',\n\t    'maxNativeZoom': 13,\n\t    getFeatureId,\n\t    'vectorTileLayerStyles': { '': function (props) {\n\t\treturn hiddenYear(props.date.substr(0, 4)) ? [] : {\n\t\t    'opacity': 0,\n\t\t    'weight': 20,\n\t\t};\n\t    } },\n\t    'interactive': true,\n\t}\n    ).on('mouseover', function (evt) {\n\tconst date = getFeatureId(evt.layer);\n\twalkLayer.setFeatureStyle(date, trackStyle(true));\n    }).on('mouseout', function (evt) {\n\tconst date = getFeatureId(evt.layer);\n\tif (date === selected()) {\n\t    walkLayer.setFeatureStyle(date, trackStyle());\n\t} else {\n\t    walkLayer.resetFeatureStyle(date);\n\t}\n    }).addTo(gpxmap);\n\n    require([ `dA/json!${options.index}` ], function (walks) {\n\t// Collect all years.\n\tconst years = {};\n\twalks.flatMap(walk => walk.dates).\n\t    forEach(date => years[date.substr(0, 4)] = true);\n\n\t// Build popup from matching index entry.\n\tmouseLayer.on('click', function (evt) {\n\t    const date = getFeatureId(evt.layer);\n\n\t    L.DomEvent.stopPropagation(evt);\n\t    if (date === selected()) {\n\t\treturn;\n\t    }\n\t    deselect();\n\t    selected(date);\n\t    walkLayer.setFeatureStyle(date, trackStyle(true));\n\n\t    renderSummary();\n\t});\n\n\t// Set up a summary pane that reacts when years are toggled.\n\tconst sumPane = summaryPane(walks, renderSummary);\n\tfunction renderSummary() {\n\t    const date = selected();\n\n\t    if (date) {\n\t\tconst idx = search(walks, walk => date < walk.dates[0]) - 1;\n\t\tconst popup = walkPopup(date, walks[idx]);\n\t\tif (popup) {\n\t\t    return renderDetails(popup);\n\t\t}\n\t    }\n\n\t    return renderDetails({\n\t\t'title': options.title,\n\t\t'content': sumPane.render(),\n\t    });\n\t}\n\n\tfunction deselect() {\n\t    const date = selected();\n\t    if (date) {\n\t\tselected(void 0);\n\t\twalkLayer.resetFeatureStyle(date);\n\t\trenderSummary();\n\t    }\n\t}\n\tgpxmap.on('click', deselect);\n\n\t// Create one layer group per year and add to the map.\n\tObject.keys(years).forEach(function (year) {\n\t    const lg = L.layerGroup().on('add', function () {\n\t\tif (hiddenYear(year)) {\n\t\t    hiddenYear(year, false);\n\t\t    walkLayer.redraw();\n\t\t    mouseLayer.redraw();\n\t\t}\n\t    }).on('remove', function () {\n\t\tif (!hiddenYear(year)) {\n\t\t    hiddenYear(year, true);\n\t\t    walkLayer.redraw();\n\t\t    mouseLayer.redraw();\n\t\t}\n\t    });\n\t    if (!hiddenYear(year)) {\n\t\tgpxmap.addLayer(lg);\n\t    }\n\t    layersControl.addOverlay(lg, year);\n\t    sumPane.addLayer(lg, year);\n\t});\n\n\t// Adjust the map's viewport when all GPX tracks are loaded\n\tconst bounds = L.latLngBounds(walks.flatMap(walk => walk.bboxes).\n\t    flatMap(function (bbox) {\n\t\tconst l = bbox.length >> 1;\n\t\treturn L.GeoJSON.coordsToLatLngs([\n\t\t    [ bbox[0], bbox[1] ], [ bbox[l], bbox[1 + l] ]\n\t\t]);\n\t    })\n\t);\n\tgpxmap.setMaxBounds(bounds.pad(.05));\n\tif (0 <= savedZoom()) {\n\t    try {\n\t\tgpxmap.setView(savedLocation(), savedZoom());\n\t    } catch (exc) {\n\t\tconsole.error(exc);\n\t\tgpxmap.fitBounds(bounds);\n\t    }\n\t} else {\n\t    gpxmap.fitBounds(bounds);\n\t}\n\tgpxmap.on('moveend', function () {\n\t    savedLocation(this.getCenter());\n\t    savedZoom(this.getZoom());\n\t});\n    });\n\n    return gpxmap;\n}\n","/*\n * Copyright 2017, Joachim Kuebart <joachim.kuebart@gmail.com>\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *\n *   1. Redistributions of source code must retain the above copyright\n *\tnotice, this list of conditions and the following disclaimer.\n *\n *   2. Redistributions in binary form must reproduce the above copyright\n *\tnotice, this list of conditions and the following disclaimer in the\n *\tdocumentation and/or other materials provided with the\n *\tdistribution.\n *\n *   3. Neither the name of the copyright holder nor the names of its\n *\tcontributors may be used to endorse or promote products derived\n *\tfrom this software without specific prior written permission.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\"\n * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE\n * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE\n * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF\n * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS\n * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN\n * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n * POSSIBILITY OF SUCH DAMAGE.\n */\n\n// Missing monadic operation\nif ('function' !== typeof Array.prototype.flatMap) {\n    Object.defineProperty(Array.prototype, 'flatMap', {\n\t'value': function () {\n\t    'use strict';\n\n\t    // return [].concat(f(this[0]), f(this[1]), ...)\n\t    return Array.prototype.concat.apply([],\n\t\tArray.prototype.map.apply(this, arguments)\n\t    );\n\t},\n    });\n}\n","\n\nL.SVG.Tile = L.SVG.extend({\n\n\tinitialize: function (tileCoord, tileSize, options) {\n\t\tL.SVG.prototype.initialize.call(this, options);\n\t\tthis._tileCoord = tileCoord;\n\t\tthis._size = tileSize;\n\n\t\tthis._initContainer();\n\t\tthis._container.setAttribute('width', this._size.x);\n\t\tthis._container.setAttribute('height', this._size.y);\n\t\tthis._container.setAttribute('viewBox', [0, 0, this._size.x, this._size.y].join(' '));\n\n\t\tif (options.interactive) {\n\t\t\t// By default, Leaflet tiles do not have pointer events\n\t\t\tthis._container.style.pointerEvents = 'auto';\n\t\t}\n\t\tthis._layers = {};\n\t},\n\n\tgetCoord: function() {\n\t\treturn this._tileCoord;\n\t},\n\n\tgetContainer: function() {\n\t\treturn this._container;\n\t},\n\n\tonAdd: L.Util.falseFn,\n\n\taddTo: function(map) {\n\t\tthis._map = map;\n\t\tif (this.options.interactive) {\n\t\t\tfor (var i in this._layers) {\n\t\t\t\tvar layer = this._layers[i];\n\t\t\t\tthis._map._targets[L.stamp(layer._path)] = layer;\n\t\t\t}\n\t\t}\n\t},\n\n\t_initContainer: function() {\n\t\tL.SVG.prototype._initContainer.call(this);\n\t\tvar rect =  L.SVG.create('rect');\n\t},\n\n\t/// TODO: Modify _initPath to include an extra parameter, a group name\n\t/// to order symbolizers by z-index\n\n\t_addPath: function (layer) {\n\t\tthis._rootGroup.appendChild(layer._path);\n\t\tthis._layers[L.stamp(layer)] = layer;\n\t},\n\n\t_updateIcon: function (layer) {\n\t\tvar path = layer._path = L.SVG.create('image'),\n\t\t    icon = layer.options.icon,\n\t\t    options = icon.options,\n\t\t    size = L.point(options.iconSize),\n\t\t    anchor = options.iconAnchor ||\n\t\t        \t size && size.divideBy(2, true),\n\t\t    p = layer._point.subtract(anchor);\n\t\tpath.setAttribute('x', p.x);\n\t\tpath.setAttribute('y', p.y);\n\t\tpath.setAttribute('width', size.x + 'px');\n\t\tpath.setAttribute('height', size.y + 'px');\n\t\tpath.setAttribute('href', options.iconUrl);\n\t}\n});\n\n\nL.svg.tile = function(tileCoord, tileSize, opts){\n\treturn new L.SVG.Tile(tileCoord, tileSize, opts);\n}\n\n","import {} from './Leaflet.Renderer.SVG.Tile.js';\n\nL.VectorGrid = L.GridLayer.extend({\n\n\toptions: {\n\t\trendererFactory: L.svg.tile,\n\t\tvectorTileLayerStyles: {},\n\t\tinteractive: false\n\t},\n\n\tinitialize: function(options) {\n\t\tL.setOptions(this, options);\n\t\tL.GridLayer.prototype.initialize.apply(this, arguments);\n\t\tif (this.options.getFeatureId) {\n\t\t\tthis._vectorTiles = {};\n\t\t\tthis._overriddenStyles = {};\n\t\t\tthis.on('tileunload', function(e) {\n\t\t\t\tdelete this._vectorTiles[this._tileCoordsToKey(e.coords)];\n\t\t\t}, this);\n\t\t}\n\t},\n\n\tcreateTile: function(coords, done) {\n\t\tvar storeFeatures = this.options.getFeatureId;\n\n\t\tvar tileSize = this.getTileSize();\n\t\tvar renderer = this.options.rendererFactory(coords, tileSize, this.options);\n\n\t\tvar vectorTilePromise = this._getVectorTilePromise(coords);\n\n\t\tif (storeFeatures) {\n\t\t\tthis._vectorTiles[this._tileCoordsToKey(coords)] = renderer;\n\t\t\trenderer._features = {};\n\t\t}\n\n\t\tvectorTilePromise.then( function renderTile(vectorTile) {\n\t\t\tfor (var layerName in vectorTile.layers) {\n\t\t\t\tvar layer = vectorTile.layers[layerName];\n\n\t\t\t\t/// NOTE: THIS ASSUMES SQUARE TILES!!!!!1!\n\t\t\t\tvar pxPerExtent = this.getTileSize().x / layer.extent;\n\n\t\t\t\tvar layerStyle = this.options.vectorTileLayerStyles[ layerName ] ||\n\t\t\t\tL.Path.prototype.options;\n\n\t\t\t\tfor (var i in layer.features) {\n\t\t\t\t\tvar feat = layer.features[i];\n\t\t\t\t\tvar id;\n\n\t\t\t\t\tvar styleOptions = layerStyle;\n\t\t\t\t\tif (storeFeatures) {\n\t\t\t\t\t\tid = this.options.getFeatureId(feat);\n\t\t\t\t\t\tvar styleOverride = this._overriddenStyles[id];\n\t\t\t\t\t\tif (styleOverride) {\n\t\t\t\t\t\t\tif (styleOverride[layerName]) {\n\t\t\t\t\t\t\t\tstyleOptions = styleOverride[layerName];\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tstyleOptions = styleOverride;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (styleOptions instanceof Function) {\n\t\t\t\t\t\tstyleOptions = styleOptions(feat.properties, coords.z);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!(styleOptions instanceof Array)) {\n\t\t\t\t\t\tstyleOptions = [styleOptions];\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!styleOptions.length) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tvar featureLayer = this._createLayer(feat, pxPerExtent);\n\n\t\t\t\t\tfor (var j in styleOptions) {\n\t\t\t\t\t\tvar style = L.extend({}, L.Path.prototype.options, styleOptions[j]);\n\t\t\t\t\t\tfeatureLayer.render(renderer, style);\n\t\t\t\t\t\trenderer._addPath(featureLayer);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (this.options.interactive) {\n\t\t\t\t\t\tfeatureLayer.makeInteractive();\n\t\t\t\t\t}\n\n\t\t\t\t\tif (storeFeatures) {\n\t\t\t\t\t\trenderer._features[id] = {\n\t\t\t\t\t\t\tlayerName: layerName,\n\t\t\t\t\t\t\tfeature: featureLayer\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t}\n\t\t\tif (this._map != null) {\n\t\t\t\trenderer.addTo(this._map);\n\t\t\t}\n\t\t\tL.Util.requestAnimFrame(done.bind(coords, null, null));\n\t\t}.bind(this));\n\n\t\treturn renderer.getContainer();\n\t},\n\n\tsetFeatureStyle: function(id, layerStyle) {\n\t\tthis._overriddenStyles[id] = {}\n\n\t\tfor (var tileKey in this._vectorTiles) {\n\t\t\tvar tile = this._vectorTiles[tileKey];\n\t\t\tvar features = tile._features;\n\t\t\tvar data = features[id];\n\t\t\tif (data) {\n\t\t\t\tthis._overriddenStyles[id] = layerStyle;\n\t\t\t\tvar feat = data.feature;\n\n\t\t\t\tvar styleOptions = layerStyle;\n\t\t\t\tif (layerStyle[data.layerName]) {\n\t\t\t\t\tstyleOptions = layerStyle[data.layerName];\n\t\t\t\t}\n\n\t\t\t\tstyleOptions = (styleOptions instanceof Function) ?\n\t\t\t\t\tstyleOptions(feat.properties, tile.getCoord().z) :\n\t\t\t\t\tstyleOptions;\n\n\t\t\t\tthis._updateStyles(feat, tile, styleOptions);\n\t\t\t} else {\n\t\t\t\tthis._overriddenStyles[id] = layerStyle;\n\t\t\t}\n\t\t}\n\t},\n\n\tresetFeatureStyle: function(id) {\n\t\tdelete this._overriddenStyles[id];\n\n\t\tfor (var tileKey in this._vectorTiles) {\n\t\t\tvar tile = this._vectorTiles[tileKey];\n\t\t\tvar features = tile._features;\n\t\t\tvar data = features[id];\n\t\t\tif (data) {\n\t\t\t\tvar feat = data.feature;\n\t\t\t\tvar layerStyle = this.options.vectorTileLayerStyles[ data.layerName ] ||\n\t\t\t\tL.Path.prototype.options;\n\t\t\t\tvar styleOptions = (layerStyle instanceof Function) ?\n\t\t\t\tlayerStyle(feat.properties, tile.getCoord().z) :\n\t\t\t\tlayerStyle;\n\t\t\t\tthis._updateStyles(feat, tile, styleOptions);\n\t\t\t}\n\t\t}\n\t},\n\n\t_updateStyles: function(feat, renderer, styleOptions) {\n\t\tif (!(styleOptions instanceof Array)) {\n\t\t\tstyleOptions = [styleOptions];\n\t\t}\n\n\t\tfor (var j in styleOptions) {\n\t\t\tvar style = L.extend({}, L.Path.prototype.options, styleOptions[j]);\n\t\t\tfeat.updateStyle(renderer, style);\n\t\t}\n\t},\n\n\t_createLayer: function(feat, pxPerExtent, layerStyle) {\n\t\tvar layer;\n\t\tswitch (feat.type) {\n\t\tcase 1:\n\t\t\tlayer = new PointLayer(feat, pxPerExtent);\n\t\t\tbreak;\n\t\tcase 2:\n\t\t\tlayer = new PolylineLayer(feat, pxPerExtent);\n\t\t\tbreak;\n\t\tcase 3:\n\t\t\tlayer = new PolygonLayer(feat, pxPerExtent);\n\t\t\tbreak;\n\t\t}\n\n\t\tif (this.options.interactive) {\n\t\t\tlayer.addEventParent(this);\n\t\t}\n\n\t\treturn layer;\n\t},\n});\n\nL.vectorGrid = function (options) {\n\treturn new L.VectorGrid(options);\n};\n\nvar FeatureLayer = L.Class.extend({\n\trender: function(renderer, style) {\n\t\tthis._renderer = renderer;\n\t\tthis.options = style;\n\t\trenderer._initPath(this);\n\t\trenderer._updateStyle(this);\n\t},\n\n\tupdateStyle: function(renderer, style) {\n\t\tthis.options = style;\n\t\trenderer._updateStyle(this);\n\t},\n\n\t_getPixelBounds: function() {\n\t\tvar parts = this._parts;\n\t\tvar bounds = L.bounds([]);\n\t\tfor (var i = 0; i < parts.length; i++) {\n\t\t\tvar part = parts[i];\n\t\t\tfor (var j = 0; j < part.length; j++) {\n\t\t\t\tbounds.extend(part[j]);\n\t\t\t}\n\t\t}\n\n\t\tvar w = this._clickTolerance(),\n\t\t    p = new L.Point(w, w);\n\n\t\tbounds.min._subtract(p);\n\t\tbounds.max._add(p);\n\n\t\treturn bounds;\n\t},\n\t_clickTolerance: L.Path.prototype._clickTolerance,\n});\n\nvar PointLayer = L.CircleMarker.extend({\n\tincludes: FeatureLayer.prototype,\n\n\tstatics: {\n\t\ticonCache: {}\n\t},\n\n\tinitialize: function(feature, pxPerExtent) {\n\t\tthis.properties = feature.properties;\n\t\tthis._makeFeatureParts(feature, pxPerExtent);\n\t},\n\n\trender: function(renderer, style) {\n\t\tFeatureLayer.prototype.render.call(this, renderer, style);\n\t\tthis._radius = style.radius || L.CircleMarker.prototype.options.radius;\n\t\tthis._updatePath();\n\t},\n\n\t_makeFeatureParts: function(feat, pxPerExtent) {\n\t\tvar coord = feat.geometry[0];\n\t\tif (typeof coord[0] === 'object' && 'x' in coord[0]) {\n\t\t\t// Protobuf vector tiles return [{x: , y:}]\n\t\t\tthis._point = L.point(coord[0].x * pxPerExtent, coord[0].y * pxPerExtent);\n\t\t\tthis._empty = L.Util.falseFn;\n\t\t} else {\n\t\t\t// Geojson-vt returns [,]\n\t\t\tthis._point = L.point(coord[0] * pxPerExtent, coord[1] * pxPerExtent);\n\t\t\tthis._empty = L.Util.falseFn;\n\t\t}\n\t},\n\n\tmakeInteractive: function() {\n\t\tthis._updateBounds();\n\t},\n\n\tupdateStyle: function(renderer, style) {\n\t\tthis._radius = style.radius || this._radius;\n\t\tthis._updateBounds();\n\t\treturn FeatureLayer.prototype.updateStyle.call(this, renderer, style);\n\t},\n\n\t_updateBounds: function() {\n\t\tvar icon = this.options.icon\n\t\tif (icon) {\n\t\t\tvar size = L.point(icon.options.iconSize),\n\t\t\t    anchor = icon.options.iconAnchor ||\n\t\t\t             size && size.divideBy(2, true),\n\t\t\t    p = this._point.subtract(anchor);\n\t\t\tthis._pxBounds = new L.Bounds(p, p.add(icon.options.iconSize));\n\t\t} else {\n\t\t\tL.CircleMarker.prototype._updateBounds.call(this);\n\t\t}\n\t},\n\n\t_updatePath: function() {\n\t\tif (this.options.icon) {\n\t\t\tthis._renderer._updateIcon(this)\n\t\t} else {\n\t\t\tL.CircleMarker.prototype._updatePath.call(this);\n\t\t}\n\t},\n\n\t_getImage: function () {\n\t\tif (this.options.icon) {\n\t\t\tvar url = this.options.icon.options.iconUrl,\n\t\t\t    img = PointLayer.iconCache[url];\n\t\t\tif (!img) {\n\t\t\t\tvar icon = this.options.icon;\n\t\t\t\timg = PointLayer.iconCache[url] = icon.createIcon();\n\t\t\t}\n\t\t\treturn img;\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\n\t},\n\n\t_containsPoint: function(p) {\n\t\tvar icon = this.options.icon;\n\t\tif (icon) {\n\t\t\treturn this._pxBounds.contains(p);\n\t\t} else {\n\t\t\treturn L.CircleMarker.prototype._containsPoint.call(this, p);\n\t\t}\n\t}\n});\n\nvar polyBase = {\n\t_makeFeatureParts: function(feat, pxPerExtent) {\n\t\tvar rings = feat.geometry;\n\t\tvar coord;\n\n\t\tthis._parts = [];\n\t\tfor (var i in rings) {\n\t\t\tvar ring = rings[i];\n\t\t\tvar part = [];\n\t\t\tfor (var j in ring) {\n\t\t\t\tcoord = ring[j];\n\t\t\t\tif ('x' in coord) {\n\t\t\t\t\t// Protobuf vector tiles return {x: , y:}\n\t\t\t\t\tpart.push(L.point(coord.x * pxPerExtent, coord.y * pxPerExtent));\n\t\t\t\t} else {\n\t\t\t\t\t// Geojson-vt returns [,]\n\t\t\t\t\tpart.push(L.point(coord[0] * pxPerExtent, coord[1] * pxPerExtent));\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis._parts.push(part);\n\t\t}\n\t},\n\n\tmakeInteractive: function() {\n\t\tthis._pxBounds = this._getPixelBounds();\n\t}\n};\n\nvar PolylineLayer = L.Polyline.extend({\n\tincludes: [FeatureLayer.prototype, polyBase],\n\n\tinitialize: function(feature, pxPerExtent) {\n\t\tthis.properties = feature.properties;\n\t\tthis._makeFeatureParts(feature, pxPerExtent);\n\t},\n\n\trender: function(renderer, style) {\n\t\tstyle.fill = false;\n\t\tFeatureLayer.prototype.render.call(this, renderer, style);\n\t\tthis._updatePath();\n\t},\n\n\tupdateStyle: function(renderer, style) {\n\t\tstyle.fill = false;\n\t\tFeatureLayer.prototype.updateStyle.call(this, renderer, style);\n\t},\n});\n\nvar PolygonLayer = L.Polygon.extend({\n\tincludes: [FeatureLayer.prototype, polyBase],\n\n\tinitialize: function(feature, pxPerExtent) {\n\t\tthis.properties = feature.properties;\n\t\tthis._makeFeatureParts(feature, pxPerExtent);\n\t},\n\n\trender: function(renderer, style) {\n\t\tFeatureLayer.prototype.render.call(this, renderer, style);\n\t\tthis._updatePath();\n\t}\n});\n","exports.read = function (buffer, offset, isLE, mLen, nBytes) {\n  var e, m\n  var eLen = nBytes * 8 - mLen - 1\n  var eMax = (1 << eLen) - 1\n  var eBias = eMax >> 1\n  var nBits = -7\n  var i = isLE ? (nBytes - 1) : 0\n  var d = isLE ? -1 : 1\n  var s = buffer[offset + i]\n\n  i += d\n\n  e = s & ((1 << (-nBits)) - 1)\n  s >>= (-nBits)\n  nBits += eLen\n  for (; nBits > 0; e = e * 256 + buffer[offset + i], i += d, nBits -= 8) {}\n\n  m = e & ((1 << (-nBits)) - 1)\n  e >>= (-nBits)\n  nBits += mLen\n  for (; nBits > 0; m = m * 256 + buffer[offset + i], i += d, nBits -= 8) {}\n\n  if (e === 0) {\n    e = 1 - eBias\n  } else if (e === eMax) {\n    return m ? NaN : ((s ? -1 : 1) * Infinity)\n  } else {\n    m = m + Math.pow(2, mLen)\n    e = e - eBias\n  }\n  return (s ? -1 : 1) * m * Math.pow(2, e - mLen)\n}\n\nexports.write = function (buffer, value, offset, isLE, mLen, nBytes) {\n  var e, m, c\n  var eLen = nBytes * 8 - mLen - 1\n  var eMax = (1 << eLen) - 1\n  var eBias = eMax >> 1\n  var rt = (mLen === 23 ? Math.pow(2, -24) - Math.pow(2, -77) : 0)\n  var i = isLE ? 0 : (nBytes - 1)\n  var d = isLE ? 1 : -1\n  var s = value < 0 || (value === 0 && 1 / value < 0) ? 1 : 0\n\n  value = Math.abs(value)\n\n  if (isNaN(value) || value === Infinity) {\n    m = isNaN(value) ? 1 : 0\n    e = eMax\n  } else {\n    e = Math.floor(Math.log(value) / Math.LN2)\n    if (value * (c = Math.pow(2, -e)) < 1) {\n      e--\n      c *= 2\n    }\n    if (e + eBias >= 1) {\n      value += rt / c\n    } else {\n      value += rt * Math.pow(2, 1 - eBias)\n    }\n    if (value * c >= 2) {\n      e++\n      c /= 2\n    }\n\n    if (e + eBias >= eMax) {\n      m = 0\n      e = eMax\n    } else if (e + eBias >= 1) {\n      m = (value * c - 1) * Math.pow(2, mLen)\n      e = e + eBias\n    } else {\n      m = value * Math.pow(2, eBias - 1) * Math.pow(2, mLen)\n      e = 0\n    }\n  }\n\n  for (; mLen >= 8; buffer[offset + i] = m & 0xff, i += d, m /= 256, mLen -= 8) {}\n\n  e = (e << mLen) | m\n  eLen += mLen\n  for (; eLen > 0; buffer[offset + i] = e & 0xff, i += d, e /= 256, eLen -= 8) {}\n\n  buffer[offset + i - d] |= s * 128\n}\n","module.exports.VectorTile = require('./lib/vectortile.js');\nmodule.exports.VectorTileFeature = require('./lib/vectortilefeature.js');\nmodule.exports.VectorTileLayer = require('./lib/vectortilelayer.js');\n","\nimport Pbf from 'pbf';\nimport {VectorTile} from 'vector-tile';\n\n// Network & Protobuf powered!\n// NOTE: Assumes the globals `VectorTile` and `Pbf` exist!!!\nL.VectorGrid.Protobuf = L.VectorGrid.extend({\n\n\toptions: {\n\t\tminZoom: 0,\t\t// Like L.TileLayer\n\t\tmaxZoom: 18,\t\t// Like L.TileLayer\n\t\tmaxNativeZoom: null,\t// Like L.TileLayer\n\t\tminNativeZoom: null,\t// Like L.TileLayer\n\t\tsubdomains: 'abc',\t// Like L.TileLayer\n\t\tzoomOffset: 0,\t\t// Like L.TileLayer\n\t\tzoomReverse: false,\t// Like L.TileLayer\n\t},\n\n\n\tinitialize: function(url, options) {\n\t\t// Inherits options from geojson-vt!\n// \t\tthis._slicer = geojsonvt(geojson, options);\n\t\tthis._url = url;\n\t\tL.VectorGrid.prototype.initialize.call(this, options);\n\t},\n\n\n\t_getSubdomain: L.TileLayer.prototype._getSubdomain,\n\n\tgetTileSize: L.TileLayer.prototype.getTileSize,\n\n\t_getZoomForUrl: L.TileLayer.prototype._getZoomForUrl,\n\n\t_getVectorTilePromise: function(coords) {\n\t\tvar data = {\n\t\t\ts: this._getSubdomain(coords),\n\t\t\tx: coords.x,\n\t\t\ty: coords.y,\n\t\t\tz: this._getZoomForUrl(),\n\t\t};\n\t\tif (this._map && !this._map.options.crs.infinite) {\n\t\t\tvar invertedY = this._globalTileRange.max.y - coords.y;\n\t\t\tif (this.options.tms) { // Should this option be available in Leaflet.VectorGrid?\n\t\t\t\tdata['y'] = invertedY;\n\t\t\t}\n\t\t\tdata['-y'] = invertedY;\n\t\t}\n\n\t\tvar tileUrl = L.Util.template(this._url, L.extend(data, this.options));\n\n\t\treturn fetch(tileUrl).then(function(response){\n\n\t\t\tif (!response.ok) {\n\t\t\t\treturn {layers:[]};\n\t\t\t}\n\n\t\t\treturn response.blob().then( function (blob) {\n// \t\t\t\tconsole.log(blob);\n\n\t\t\t\tvar reader = new FileReader();\n\t\t\t\treturn new Promise(function(resolve){\n\t\t\t\t\treader.addEventListener(\"loadend\", function() {\n\t\t\t\t\t\t// reader.result contains the contents of blob as a typed array\n\n\t\t\t\t\t\t// blob.type === 'application/x-protobuf'\n\t\t\t\t\t\tvar pbf = new Pbf( reader.result );\n// \t\t\t\t\t\tconsole.log(pbf);\n\t\t\t\t\t\treturn resolve(new VectorTile( pbf ));\n\n\t\t\t\t\t});\n\t\t\t\t\treader.readAsArrayBuffer(blob);\n\t\t\t\t});\n\t\t\t});\n\t\t}).then(function(json){\n\n// \t\t\tconsole.log('Vector tile:', json.layers);\n// \t\t\tconsole.log('Vector tile water:', json.layers.water);\t// Instance of VectorTileLayer\n\n\t\t\t// Normalize feature getters into actual instanced features\n\t\t\tfor (var layerName in json.layers) {\n\t\t\t\tvar feats = [];\n\n\t\t\t\tfor (var i=0; i<json.layers[layerName].length; i++) {\n\t\t\t\t\tvar feat = json.layers[layerName].feature(i);\n\t\t\t\t\tfeat.geometry = feat.loadGeometry();\n\t\t\t\t\tfeats.push(feat);\n\t\t\t\t}\n\n\t\t\t\tjson.layers[layerName].features = feats;\n\t\t\t}\n\n\t\t\treturn json;\n\t\t});\n\t}\n});\n\n\nL.vectorGrid.protobuf = function (url, options) {\n\treturn new L.VectorGrid.Protobuf(url, options);\n};\n\n","\n\nL.Canvas.Tile = L.Canvas.extend({\n\n\tinitialize: function (tileCoord, tileSize, options) {\n\t\tL.Canvas.prototype.initialize.call(this, options);\n\t\tthis._tileCoord = tileCoord;\n\t\tthis._size = tileSize;\n\n\t\tthis._initContainer();\n\t\tthis._container.setAttribute('width', this._size.x);\n\t\tthis._container.setAttribute('height', this._size.y);\n\t\tthis._layers = {};\n\t\tthis._drawnLayers = {};\n\t\tthis._drawing = true;\n\n\t\tif (options.interactive) {\n\t\t\t// By default, Leaflet tiles do not have pointer events\n\t\t\tthis._container.style.pointerEvents = 'auto';\n\t\t}\n\t},\n\n\tgetCoord: function() {\n\t\treturn this._tileCoord;\n\t},\n\n\tgetContainer: function() {\n\t\treturn this._container;\n\t},\n\n\tgetOffset: function() {\n\t\treturn this._tileCoord.scaleBy(this._size).subtract(this._map.getPixelOrigin());\n\t},\n\n\tonAdd: L.Util.falseFn,\n\n\taddTo: function(map) {\n\t\tthis._map = map;\n\t},\n\n\t_onClick: function (e) {\n\t\tvar point = this._map.mouseEventToLayerPoint(e).subtract(this.getOffset()), layers = [], layer;\n\n\t\tfor (var id in this._layers) {\n\t\t\tlayer = this._layers[id];\n\t\t\tif (layer.options.interactive && layer._containsPoint(point) && !this._map._draggableMoved(layer)) {\n\t\t\t\tL.DomEvent._fakeStop(e);\n\t\t\t\tlayers.push(layer);\n\t\t\t}\n\t\t}\n\t\tif (layers.length)  {\n\t\t\tthis._fireEvent(layers, e);\n\t\t}\n\t},\n\n\t_onMouseMove: function (e) {\n\t\tif (!this._map || this._map.dragging.moving() || this._map._animatingZoom) { return; }\n\n\t\tvar point = this._map.mouseEventToLayerPoint(e).subtract(this.getOffset());\n\t\tthis._handleMouseOut(e, point);\n\t\tthis._handleMouseHover(e, point);\n\t},\n\n\t/// TODO: Modify _initPath to include an extra parameter, a group name\n\t/// to order symbolizers by z-index\n\n\t_updateIcon: function (layer) {\n\t\tif (!this._drawing) { return; }\n\n\t\tvar icon = layer.options.icon,\n\t\t    options = icon.options,\n\t\t    size = L.point(options.iconSize),\n\t\t    anchor = options.iconAnchor ||\n\t\t        \t size && size.divideBy(2, true),\n\t\t    p = layer._point.subtract(anchor),\n\t\t    ctx = this._ctx,\n\t\t    img = layer._getImage();\n\n\t\tif (img.complete) {\n\t\t\tctx.drawImage(img, p.x, p.y, size.x, size.y);\n\t\t} else {\n\t\t\tL.DomEvent.on(img, 'load', function() {\n\t\t\t\tctx.drawImage(img, p.x, p.y, size.x, size.y);\n\t\t\t});\n\t\t}\n\n\t\tthis._drawnLayers[layer._leaflet_id] = layer;\n\t}\n});\n\n\nL.canvas.tile = function(tileCoord, tileSize, opts){\n\treturn new L.Canvas.Tile(tileCoord, tileSize, opts);\n}\n\n"],"names":["Pbf","buf","this","ArrayBuffer","isView","Uint8Array","pos","type","length","readVarintRemainder","l","s","p","h","b","toNum","Error","readPackedEnd","pbf","Bytes","readVarint","low","high","isSigned","writeBigVarint","val","realloc","writeBigVarintLow","writeBigVarintHigh","lsb","makeRoomForExtraLength","startPos","len","extraLen","Math","ceil","log","LN2","i","writePackedVarint","arr","writeVarint","writePackedSVarint","writeSVarint","writePackedFloat","writeFloat","writePackedDouble","writeDouble","writePackedBoolean","writeBoolean","writePackedFixed32","writeFixed32","writePackedSFixed32","writeSFixed32","writePackedFixed64","writeFixed64","writePackedSFixed64","writeSFixed64","readUInt32","writeInt32","readInt32","readUtf8","end","str","b0","c","bytesPerSequence","b1","b2","b3","String","fromCharCode","writeUtf8","lead","charCodeAt","Point","x","y","VectorTileFeature","extent","keys","values","properties","_pbf","_geometry","_keys","_values","readFields","readFeature","tag","feature","id","readTag","key","value","classifyRings","rings","polygon","ccw","polygons","area","signedArea","undefined","push","ring","p1","p2","sum","j","VectorTileLayer","version","name","_features","readLayer","layer","readString","readValueMessage","readFloat","readDouble","readVarint64","readSVarint","readBoolean","VectorTile","layers","readTile","zip","const","args","Array","prototype","slice","call","arguments","Object","map","a","summary","summaryImp","m_walks","m_distance","self","walks","distance","toString","toFixed","join","accumulate","dist","summaryPane","onChange","handleVisible","year","visible","m_visibleYears","m_summary","flatMap","walk","dates","distances","reduce","dateDistance","substr","addLayer","on","bind","removeLayer","off","render","frag","document","createDocumentFragment","div","createElement","textContent","appendChild","search","array","pred","let","le","ri","mi","yearColour","idx","walkPopup","date","d","console","popup","elem0","categories","anchor","setAttribute","link","people","sort","title","content","getFeatureId","locationState","obj","state","window","history","forEach","k","replaceState","locationItem","savedLocation","L","latLng","lat","lng","@","f","hiddenYear","hidden","concat","indexOf","years","newState","filter","gpxmap","options","renderDetails","ref","h3","DomUtil","create","empty","domDetails","trackStyle","hover","props","className","CSS","TRACK","color","opacity","weight","selected","interactive","tileLayers","tileLayer","url","layersControl","control","hideSingleBase","addBaseLayer","domContainer","get","addClass","VBOX","VIEW","addControl","scale","DETAILS","walkLayer","vectorGrid","protobuf","pane","maxNativeZoom","vectorTileLayerStyles","addTo","mouseLayer","evt","setFeatureStyle","resetFeatureStyle","require","renderSummary","sumPane","deselect","DomEvent","stopPropagation","lg","layerGroup","redraw","addOverlay","bounds","latLngBounds","bboxes","bbox","GeoJSON","coordsToLatLngs","setMaxBounds","pad","savedZoom","setView","exc","error","fitBounds","getCenter","getZoom","defineProperty","apply","SVG","Tile","extend","initialize","tileCoord","tileSize","_tileCoord","_size","_initContainer","_container","style","pointerEvents","_layers","getCoord","getContainer","onAdd","Util","falseFn","_map","_targets","stamp","_path","_addPath","_rootGroup","_updateIcon","path","icon","size","point","iconSize","iconAnchor","divideBy","_point","subtract","iconUrl","svg","tile","opts","VectorGrid","GridLayer","rendererFactory","setOptions","_vectorTiles","_overriddenStyles","e","_tileCoordsToKey","coords","createTile","done","storeFeatures","getTileSize","renderer","vectorTilePromise","_getVectorTilePromise","then","vectorTile","layerName","pxPerExtent","layerStyle","Path","features","feat","styleOptions","styleOverride","Function","z","featureLayer","_createLayer","makeInteractive","requestAnimFrame","tileKey","data","_updateStyles","updateStyle","PointLayer","PolylineLayer","PolygonLayer","addEventParent","FeatureLayer","Class","_renderer","_initPath","_updateStyle","_getPixelBounds","parts","_parts","part","w","_clickTolerance","min","_subtract","max","_add","CircleMarker","includes","statics","iconCache","_makeFeatureParts","_radius","radius","_updatePath","coord","geometry","_empty","_updateBounds","_pxBounds","Bounds","add","_getImage","img","createIcon","_containsPoint","contains","polyBase","Polyline","fill","Polygon","buffer","offset","isLE","mLen","nBytes","m","eLen","eMax","eBias","nBits","NaN","Infinity","pow","rt","abs","isNaN","floor","ieee754","require$$0","Varint","Fixed64","Fixed32","SHIFT_LEFT_32","SHIFT_RIGHT_32","destroy","readField","result","skip","readMessage","readFixed32","readSFixed32","readFixed64","readSFixed64","read","num","Boolean","readBytes","subarray","readPackedVarint","readPackedSVarint","readPackedBoolean","readPackedFloat","readPackedDouble","readPackedFixed32","readPackedSFixed32","readPackedFixed64","readPackedSFixed64","writeTag","set","finish","writeString","write","writeBytes","writeRawMessage","fn","writeMessage","writeBytesField","writeFixed32Field","writeSFixed32Field","writeFixed64Field","writeSFixed64Field","writeVarintField","writeSVarintField","writeStringField","writeFloatField","writeDoubleField","writeBooleanField","clone","sub","_sub","mult","_mult","_div","rotate","_rotate","matMult","_matMult","unit","_unit","perp","_perp","round","_round","mag","sqrt","equals","distSqr","dx","dy","angle","atan2","angleTo","angleWith","angleWithSep","cos","sin","convert","isArray","types","loadGeometry","line","cmd","lines","cmdLen","x1","x2","y1","y2","toGeoJSON","project","y0","x0","PI","atan","exp","points","coordinates","Protobuf","minZoom","maxZoom","minNativeZoom","subdomains","zoomOffset","zoomReverse","_url","_getSubdomain","TileLayer","_getZoomForUrl","crs","infinite","invertedY","_globalTileRange","tms","tileUrl","template","fetch","response","ok","blob","reader","FileReader","Promise","resolve","addEventListener","readAsArrayBuffer","json","feats","Canvas","_drawnLayers","_drawing","getOffset","scaleBy","getPixelOrigin","_onClick","mouseEventToLayerPoint","_draggableMoved","_fakeStop","_fireEvent","_onMouseMove","dragging","moving","_animatingZoom","_handleMouseOut","_handleMouseHover","ctx","_ctx","complete","drawImage","_leaflet_id","canvas","HBOX","SELECT"],"mappings":"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"}